
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library for off-the-shelf machine learning models">
      
      
        <link rel="canonical" href="https://traintool.jrieke.com/tutorial/training/">
      
      
        <meta name="author" content="Johannes Rieke">
      
      <link rel="shortcut icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.1">
    
    
      
        <title>Training and Prediction - traintool</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="deep-purple">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#training-and-prediction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://traintool.jrieke.com/" title="traintool" class="md-header-nav__button md-logo" aria-label="traintool">
      
  <img src="../../assets/logo-white.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            traintool
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Training and Prediction
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jrieke/traintool/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://traintool.jrieke.com/" title="traintool" class="md-nav__button md-logo" aria-label="traintool">
      
  <img src="../../assets/logo-white.png" alt="logo">

    </a>
    traintool
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jrieke/traintool/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="About" class="md-nav__link">
      About
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Tutorial
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tutorial" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../intro/" title="Intro" class="md-nav__link">
      Intro
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Training and Prediction
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Training and Prediction" class="md-nav__link md-nav__link--active">
      Training and Prediction
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#your-first-model" class="md-nav__link">
    Your first model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-predictions" class="md-nav__link">
    Making predictions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-other-models" class="md-nav__link">
    Using other models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-hyperparameters" class="md-nav__link">
    Custom hyperparameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-and-loading-models" class="md-nav__link">
    Saving and loading models
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../experiment-tracking/" title="Experiment tracking" class="md-nav__link">
      Experiment tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../deployment/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../raw-models/" title="Getting access to raw models" class="md-nav__link">
      Getting access to raw models
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tasks and Models
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tasks and Models" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Tasks and Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/image-classification/" title="Image classification" class="md-nav__link">
      Image classification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/object-detection/" title="Object detection" class="md-nav__link">
      Object detection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/text-classification/" title="Text classification" class="md-nav__link">
      Text classification
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#your-first-model" class="md-nav__link">
    Your first model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-predictions" class="md-nav__link">
    Making predictions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-other-models" class="md-nav__link">
    Using other models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-hyperparameters" class="md-nav__link">
    Custom hyperparameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#saving-and-loading-models" class="md-nav__link">
    Saving and loading models
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jrieke/traintool/edit/master/docs/tutorial/training.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="training-and-prediction">Training and Prediction<a class="headerlink" href="#training-and-prediction" title="Permanent link">&para;</a></h1>
<h2 id="your-first-model">Your first model<a class="headerlink" href="#your-first-model" title="Permanent link">&para;</a></h2>
<p>As a first example, we'll train a very simple model: A 
<a href="https://en.wikipedia.org/wiki/Support_vector_machine">Support Vector Machine</a> or SVM. 
We will use the image classification dataset MNIST throughout this tutorial, so let's 
load it now (the <code>mnist</code> package was installed along with traintool):</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">mnist</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">mnist</span><span class="o">.</span><span class="n">train_images</span><span class="p">(),</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train_labels</span><span class="p">()]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">mnist</span><span class="o">.</span><span class="n">test_images</span><span class="p">(),</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test_labels</span><span class="p">()]</span>
</code></pre></div>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The code above loads the data as numpy arrays but traintool can also deal with 
files and pytorch datasets (see here). More data formats will be added soon.</p>
</div>
<p>Training the SVM is very simple now:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">traintool</span>
<span class="n">svm</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<p>That's it! traintool will take care of reading and converting the data, applying some 
light preprocessing, training and saving the model, and tracking all metrics. It will 
also print out the final loss and accuracy (the test accuracy should be around XX % 
here).</p>
<h2 id="making-predictions">Making predictions<a class="headerlink" href="#making-predictions" title="Permanent link">&para;</a></h2>
<p>Of course, you can do predictions with the trained model. Let's run it on an image of 
the test set:</p>
<div class="highlight"><pre><span></span><code><span class="n">pred</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted:&quot;</span><span class="p">,</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;predicted_class&quot;</span><span class="p">],</span> <span class="s2">&quot; - Is:&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<p>This should print out the predicted class and the ground truth. Note that <code>pred</code> is a 
dictionary with the predicted class (<code>pred["predicted_class"]</code>) and the probabilities 
for each class (<code>pred["probabilities"]</code>).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Again, we use a numpy array for the test image here but traintool can also handle 
pytorch tensors and files. You can even pass in a whole batch of images 
(e.g. <code>test_data[0][0:2]</code>). </p>
</div>
<h2 id="using-other-models">Using other models<a class="headerlink" href="#using-other-models" title="Permanent link">&para;</a></h2>
<p>Now, let's check a more advanced model. We will train a <a href="https://arxiv.org/abs/1512.03385">Residual Network</a> 
(ResNet), a modern deep neural network. Usually, training this model instead of an SVM 
would require you to use an advanced framework like pytorch or tensorflow and rewrite 
most of your codebase. With traintool, it's as simple replacing the model name in the <code>train</code> method:</p>
<div class="highlight"><pre><span></span><code><span class="n">resnet</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<p>And this syntax stays the same for every other model that traintool supports! This makes 
it really easy to compare a bunch of different models on your dataset and see what 
performs best. </p>
<h2 id="custom-hyperparameters">Custom hyperparameters<a class="headerlink" href="#custom-hyperparameters" title="Permanent link">&para;</a></h2>
<p>In machine learning, most models have some hyperparameters that control the training 
process (e.g. the learning rate). traintool uses sensible defaults specific to each 
model, but gives you the flexibility to fully customize everything. </p>
<p>First, let's find out which hyperparameters the model supports and what their defaults 
are:</p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">traintool</span><span class="o">.</span><span class="n">default_hyperparameters</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">))</span>
</code></pre></div>

<p>This should print out a dictionary of hyperparameters and defaults. Now, we want to 
change the learning rate and use a different optimizer. To do this, simply pass a 
<code>config</code> dict to the train method:</p>
<div class="highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;adam&quot;</span><span class="p">}</span>
<span class="n">better_resnet</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

<h2 id="saving-and-loading-models">Saving and loading models<a class="headerlink" href="#saving-and-loading-models" title="Permanent link">&para;</a></h2>
<p>There are two options to save a model to disk. Either use the <code>save</code> method after 
training like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;path/to/dir&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Or you can specify an output directory directly during training. This makes sense for 
long-running processes, so you don't lose the whole progress in case your machine is 
interrupted:</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">out_dir</span><span class="o">=</span><span class="s2">&quot;path/to/dir&quot;</span><span class="p">)</span>
</code></pre></div>

<p>In both cases, loading a model works via:</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;path/to/dir&quot;</span><span class="p">)</span>
</code></pre></div>

<!--
---

This tutorial should show you everything to get started with traintool. We'll train and 
use a few different models on MNIST. 


## Installation

In the terminal, type:

<div class="highlight"><pre><span></span><code>pip install git+https://github.com/jrieke/traintool
</code></pre></div>

Note that traintool requires Python 3.


## Data

We will use the image classification dataset MNIST throughout this tutorial. It 
contains images of handwritten digits, that need to be classified according to the 
digit 0-9. To load it, start a Python console and enter: 

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">mnist</span>
<span class="n">train_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">mnist</span><span class="o">.</span><span class="n">train_images</span><span class="p">(),</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train_labels</span><span class="p">()]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">mnist</span><span class="o">.</span><span class="n">test_images</span><span class="p">(),</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test_labels</span><span class="p">()]</span>
</code></pre></div>

The `mnist` package should have been installed along with traintool. It loads the 
images and labels as numpy arrays. 

!!! tip
    Besides numpy arrays, traintool can also handle pytorch datasets and files. More 
    data formats will be added soon.


## Training

Train a [Support Vector Machine](https://en.wikipedia.org/wiki/Support_vector_machine):

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">traintool</span>
<span class="n">svm</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;svm&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

Or train a [Residual Network](https://arxiv.org/abs/1512.03385):

<div class="highlight"><pre><span></span><code><span class="n">resnet</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>

Or train any other model that traintool supports! It's as simple as changing the model 
name – no need to learn a new framework or change your entire code base. traintool
makes it super easy to compare different models.


## Prediction

Run an image from the test set through the model:

<div class="highlight"><pre><span></span><code><span class="n">pred</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted:&quot;</span><span class="p">,</span> <span class="n">pred</span><span class="p">[</span><span class="s2">&quot;predicted_class&quot;</span><span class="p">],</span> <span class="s2">&quot; - Is:&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>

`pred` is a dictionary with the predicted class (`pred["predicted_class"]`) and the 
probabilities for each class (`pred["probabilities"]`)


## Hyperparameters

Every model comes with sensible defaults for the hyperparameters. You can get these 
defaults via: 

<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">traintool</span><span class="o">.</span><span class="n">default_hyperparameters</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">))</span>
</code></pre></div>

To change hyperparameters, pass a `config` dict to the train method:

<div class="highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;adam&quot;</span><span class="p">}</span>
<span class="n">better_resnet</span> <span class="o">=</span> <span class="n">traintool</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="s2">&quot;resnet&quot;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">train_data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="o">=</span><span class="n">test_data</span><span class="p">)</span>
</code></pre></div>
>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../intro/" title="Intro" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Intro
              </div>
            </div>
          </a>
        
        
          <a href="../experiment-tracking/" title="Experiment tracking" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Experiment tracking
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/jrieke" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/jrieke" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/in/johannesrieke/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="mailto:johannes.rieke@gmail.com" target="_blank" rel="noopener" title="" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.aa3f9871.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['tabs', 'instant'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>